---
page-title: "(13 封私信 / 80 条消息) python： if __name__ == \"__main__\" 到底是什么鬼？ - 知乎"
url: https://www.zhihu.com/question/620332455/answer/3463837655
date: "2024-04-12 22:13:45"
---
比如有一天我写了个洗脑营销的程序：

```
def spam1():
	print('还我血汗钱！')

def spam2(guy):
	print(guy + '你不是人！')

def spam3(guy):
	print(guy + '你还我血汗钱！')

def spam4(guy):
	print(guy + '和他的小姨子跑了！')

spam1()
spam1()
spam2('黄老板')
spam3('黄老板')
spam4('黄老板')
```

定义了4个函数`spam1()`~`spam4()`，并且依次调用了这几个函数。

我把这个文件保存成spam.py，运行效果非常好：

```
E:\>python spam.py
还我血汗钱！
还我血汗钱！
黄老板你不是人！
黄老板你还我血汗钱！
黄老板和他的小姨子跑了！
```

隔壁张三看到这么好的宣传效果，想借我的代码用一下，尤其是想复用我写的几个spam()函数。

他把我的spam.py拿去以后，另外写了一个zhangsanSpam.py，在其中用import导入了spam.py，并且传了他自己想骂的对象`'陈老板'`作为参数：

```
import spam

spam.spam1()
spam.spam1()
spam.spam2('陈老板')
spam.spam3('陈老板')
spam.spam4('陈老板')
```

结果运行的时候悲剧了，他也跟着把黄老板骂了一遍：

```
E:\>python zhangsanSpam.py
还我血汗钱！
还我血汗钱！
黄老板你不是人！
黄老板你还我血汗钱！
黄老板和他的小姨子跑了！
还我血汗钱！
还我血汗钱！
陈老板你不是人！
陈老板你还我血汗钱！
陈老板和他的小姨子跑了！
```

在zhangsanSpam.py里通过`import spam`导入spam.py，会执行一遍spam.py里的所有代码。这里面有张三想要的几个spam()函数的定义，但是他不想要的骂黄老板的代码也跟着运行了。

有没有啥办法在spam.py里作区分呢？我希望实现这样的效果：

-   如果spam.py被拿来直接运行，就执行那几个spam()函数
-   如果spam.py被用来当作写好的函数库，导入到其他文件里面去，就不执行那几个spam()函数

这就需要用到`__name__`了。试试看在spam.py里显示`__name__`的值：

```
def spam1():
	print('还我血汗钱！')

def spam2(guy):
	print(guy + '你不是人！')

def spam3(guy):
	print(guy + '你还我血汗钱！')

def spam4(guy):
	print(guy + '和他的小姨子跑了！')

print(__name__)
```

直接运行spam.py，可以看到`__name__`的值是`'__main__'`：

```
E:\>python spam.py
__main__
```

运行zhangsanSpam.py，它会变成`'spam'`，这是导入的库`spam`的名字。注意它显示在第一个“还我血汗钱！”的前面：

```
E:\>python zhangsanSpam.py
spam
还我血汗钱！
还我血汗钱！
陈老板你不是人！
陈老板你还我血汗钱！
陈老板和他的小姨子跑了！
```

由此我们得到了区分的方法——

-   定义函数的部分原封不动
-   “直接运行此文件时执行，但把此文件当作函数库导入的时候不运行”的代码放进if分支里。判断条件是`__name__`是否等于`'__main__'`。

据此修改一下spam.py：

```
def spam1():
	print('还我血汗钱！')

def spam2(guy):
	print(guy + '你不是人！')

def spam3(guy):
	print(guy + '你还我血汗钱！')

def spam4(guy):
	print(guy + '和他的小姨子跑了！')

if __name__ == '__main__':
	spam1()
	spam1()
	spam2('黄老板')
	spam3('黄老板')
	spam4('黄老板')
```

这样我自己可以照常用它骂黄老板：

```
E:\>python spam.py
还我血汗钱！
还我血汗钱！
黄老板你不是人！
黄老板你还我血汗钱！
黄老板和他的小姨子跑了！
```

张三拿去当作函数库，也不会骂错人了：

```
E:\>python zhangsanSpam.py
还我血汗钱！
还我血汗钱！
陈老板你不是人！
陈老板你还我血汗钱！
陈老板和他的小姨子跑了！
```

或者，如果你想趁机暗算张三这种白嫖怪，只需要再加一个判断：

```
def spam1():
	print('还我血汗钱！')

def spam2(guy):
	print(guy + '你不是人！')

def spam3(guy):
	print(guy + '你还我血汗钱！')

def spam4(guy):
	print(guy + '和他的小姨子跑了！')

if __name__ == '__main__':
	spam1()
	spam1()
	spam2('黄老板')
	spam3('黄老板')
	spam4('黄老板')

if __name__ == 'spam':
	print('我是个疯子，整天满嘴跑火车。不信你看：')
```

自己运行，完全没问题：

```
E:\>python spam.py
还我血汗钱！
还我血汗钱！
黄老板你不是人！
黄老板你还我血汗钱！
黄老板和他的小姨子跑了！
```

张三拿去，哼哼……让你白嫖！让你白嫖！

```
E:\>python zhangsanSpam.py
我是个疯子，整天满嘴跑火车。不信你看：
还我血汗钱！
还我血汗钱！
陈老板你不是人！
陈老板你还我血汗钱！
陈老板和他的小姨子跑了！
```

---

刷到本问题下的[另一个回答](https://www.zhihu.com/question/620332455/answer/3196841326)，作了更简洁的概括，值得一看。

有一条锐评说得也有道理：

![](https://picx.zhimg.com/50/v2-cd92eb1da22911a61dde00efd73d614b_720w.jpg?source=1def8aca)

我有感而发写下的回复，贴在这里与大家共勉：

> 高手之间对话自然一句话就心领神会，如果你也是如此，那当然再好不过。但是也希望你能理解，有很多人不具备这样的天份，他们需要更多的冗余才容易记住知识。  
> 不管今天已经攀登到什么高度，我们的身后无一不是无数前人铺成的道路。回头看的时候，也请不要忘了他们努力把知识变得生动有趣洒下的汗水。

---

我希望学习者都应该想清楚这样一个问题——“教程”是什么样的，“笔记”又是什么样的，以及怎样正确地使用它们。

“教程”是用来从无到有**获得一个新知识**。它会设法在「假设读者已有的知识」和「即将描述的新知识」之间建立联系。

这种联系可以是平铺直叙的，比如机械工业出版社的黑皮书系列；也可以天花乱坠充满想象，比如《Head First》系列（此回答也是在设法模仿这种风格）。

后一种方式可以在看故事、听段子之中无形地理解知识，更适合入门级别的学习。当然代价是会出现与核心知识无关的场景、人物刻画、故事发展等，一定程度上“冲淡”有效信息的密度。

“笔记”则不同，它是在已经有一个知识以后，用来**回顾、抵抗遗忘**。它会用尽可能精炼、简洁的描述直击知识里最核心的部分，因此不太会去回答“为什么是这样”“如果不这么做会发生什么事”等问题。

使用教程的时机是：理解全新的知识，或者学习过程中卡在某个位置想不通，一个好的教程负责帮你把知识的来龙去脉讲清楚。

使用笔记的时机是：曾经学习过某个知识，但时间久了记不清了，或者在备考、复习时，一份好的笔记帮助你快速回忆知识点。

两者的目的截然不同，它们也必然有着不一样的风格。此回答写的故事好不好玩，有没有把知识讲清楚，应该让读者自由评价。但是有一点是明确的——它是尽我所能把知识融合到故事里的，一个天马行空风格的“教程”。

显然，这不是也不应该是一个好的“笔记”。笔记应该像其他回答那样，用简练的一句话总结知识点。

把握好使用教程和笔记的时机，有助于提高学习的效率。

希望学习者不要拿着优秀的笔记来批评一个教程“啰里啰嗦”。天赋异禀的人也许可以过目不忘，把笔记用出教程的效果，但这不是评价教程好坏的标准，也并非展示自己过人天赋的合适方式。

对尚处于初学阶段的人多一点包容，好吗？